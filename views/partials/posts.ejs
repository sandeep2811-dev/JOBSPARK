<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>posts</title>
    <style>
        :root{
            --bg: #0b0c10;
            --panel: #121318;
            --panel-2: #161823;
            --text: #e8eaed;
            --muted: #9aa0a6;
            --brand: #7c3aed;
            --brand-2: #22d3ee;
            --border: #2a2f3a;
        }
        [data-theme="light"]{
            --bg: #f7f8fb;
            --panel: #ffffff;
            --panel-2: #f3f4f8;
            --text: #1f2937;
            --muted: #6b7280;
            --brand: #7c3aed;
            --brand-2: #0891b2;
            --border: #e5e7eb;
        }
        html, body{
            background: transparent;
            color: var(--text);
            margin:0;
            padding:0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Inter, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        }
        body::-webkit-scrollbar{
            display: none;
        }
        header{
            display:flex; align-items:center; justify-content: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        .container{
            display: flex;
            flex-direction:column;
            justify-content: center;
            align-items: stretch;
            gap:12px;
            border: 1px solid var(--border);
            border-radius: 16px;
            margin: 24px auto;
            padding: 20px;
            max-width: 700px;
            background: var(--panel);
            box-shadow: 0 8px 32px rgba(243, 116, 32, 0.18);
        }
        .container:hover{
            transform: scale(1.02);
        }
        h1{
            color: chocolate;
            letter-spacing: 1px;
            margin: 0 0 8px 0;
        }
        input, textarea{
            width:670px;
            border:1px solid var(--border);
            border-radius:10px;
            height: 40px;
            background: var(--panel-2);
            color: var(--text);
            padding: 8px 10px;
        }
        textarea{ height: auto; }
        .agree{
            height: 15px;
            width:15px;
        }
        a{ color: chocolate; }
        .complete{
            display: flex;
            flex-direction: row;
            gap:10px;
            justify-content: center;
            align-items: center;
            width:max-content;
            border: 1px solid var(--border);
            background: var(--panel-2);
            border-radius: 10px;
            padding: 6px 10px;
        }
        button{
            border:1px solid transparent;
            border-radius: 10px;
            height: 40px;
            background: chocolate;
            color: #fff;
            padding: 0 14px;
        }
        button:hover{
            cursor: pointer;
            transform: scale(1.05);
        }
        .posted{
            display: none;
            width:400px;
            height: 250px;
            border:1px solid white;
            border-radius: 10px;
        }
        /* Small floating mobile menu button (matches other partials) */
        #mobileMenuBtn {
            top: 12px;
            left: 12px;
            z-index: 9999;
            border: 1px solid var(--border);
            background: transparent; /* match dashboard hamburger */
            color: var(--text);
            padding: 8px 10px;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(0,0,0,0.25);
            display: none;
            font-family: inherit;
            width: max-content;
            height: 40px;
            font-size: 16px;
        }
        /* @media screen and (min-width:950px) { */
            /* .container{ */
                /* width: 700px; */
                /* padding: 20px; */
            /* } */
        /* } */
        @media (max-width: 720px) {
            #mobileMenuBtn {
                display: inline-flex !important;
                align-items: center;
                gap: 6px;
                padding-left: 10px;
                margin-top: 17px;
            }
            header{ display: flex; align-items: flex-start; gap:50px; justify-content: flex-start; width: 100%;  padding-left: 20px;}
            h1{ font-size: 1.5rem; }
            .container{
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                max-width: 90vw;
                height: auto;
            }
        }
        /* success modal styles */
        #jobSuccessModal {
          display: none;
          position: fixed;
          inset: 0;
          background: rgba(0,0,0,0.6);
          align-items: center;
          justify-content: center;
          z-index: 9999;
        }
        #jobSuccessModal .panel {
          background: var(--panel);
          color: var(--text);
          padding: 18px;
          border-radius: 12px;
          width: 320px;
          text-align: center;
          box-shadow: 0 8px 32px rgba(0,0,0,0.4);
        }
        #jobSuccessModal .panel h3 { margin: 0 0 8px; color: chocolate; }
        #jobSuccessModal .panel p { margin: 0 0 16px; color: var(--muted); }
        #jobSuccessModal .panel .close-btn {
          background: chocolate;
          border: none;
          color: #fff;
          padding: 10px 14px;
          border-radius: 8px;
          cursor: pointer;
        }
    </style>
</head>
<body>

<header>
  <button id="mobileMenuBtn">☰</button>
  <h1 style="text-align: center; color: chocolate; margin-top:20px; letter-spacing: 1px;">Post a New Job..!</h1>
</header>
    <div class="container">
        <form id="postForm" action="/posts" method="POST">
            <input  class="inputs" type="text" name="title" placeholder="Job Title" required>
            <br/>
            <br/>
            <input class="inputs"  type="text" name="company" placeholder="Company Name" required>
            <br/>
            <br/>
            <input class="inputs"  type="text" name="location" placeholder="Location" required>
            <br/>
            <br/>
            <input  class="inputs" type="text" name="salary" placeholder="Salary" required>
            <br/>
            <br/>
             <input  class="inputs" type="text" name="joblink" placeholder="Job Link" required>
             <br/>
             <br/>
            <textarea class="inputs"  cols="50" rows="8" name="description" placeholder="Job Description..." required></textarea>
            <br/>
            <br/>
           <center> <button id="postSubmitBtn" type="submit">Post Job</button> </center>
        </form>
    </div>

    <!-- success modal -->
    <div id="jobSuccessModal" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="panel" role="document">
        <h3>Successfully posted</h3>
        <p>Your job has been posted successfully.</p>
        <button id="jobModalClose" class="close-btn">Close</button>
      </div>
    </div>

    <script>
        let item = document.getElementsByClassName("inputs");
            for (let i=0; i<item.length; i++){
                item[i].addEventListener("focus", function(){
                    item[i].style.boxShadow = "0 8px 32px rgba(243, 116, 32, 0.18)";
                    item[i].style.border = "2px solid grey";
                    item[i].style.outline = "none";
                });
            }
        // Open parent sidebar on mobile when the button is clicked
        (function(){
            var btn = document.getElementById('mobileMenuBtn');
            if(btn){
                btn.addEventListener('click', function(){
                    try{ window.parent.postMessage({ type: 'openSidebar' }, '*'); }catch(e){}
                });
            }

            // Force styles to override any injected inline styles from parent
            function applyMenuStyles(){
                try{
                    var buttons = document.querySelectorAll('#mobileMenuBtn');
                    buttons.forEach(function(b){
                        b.style.setProperty('background','transparent','important');
                        b.style.setProperty('color','var(--text)','important');
                        b.style.setProperty('border','1px solid var(--border)','important');
                    });
                }catch(e){}
            }
            applyMenuStyles();
            // Re-apply shortly after load (parent may inject later)
            setTimeout(applyMenuStyles, 200);
            setTimeout(applyMenuStyles, 600);
            setTimeout(applyMenuStyles, 1200);
        })();

        // Intercept form submit, post via fetch and show success modal
        (function(){
          const form = document.getElementById('postForm');
          const submitBtn = document.getElementById('postSubmitBtn');
          const modal = document.getElementById('jobSuccessModal');
          const modalClose = document.getElementById('jobModalClose');

          form.addEventListener('submit', async function(e){
            e.preventDefault();
            submitBtn.disabled = true;
            submitBtn.textContent = 'Posting…';

            const formData = new FormData(form);
            const params = new URLSearchParams();
            for (const pair of formData.entries()) params.append(pair[0], pair[1]);

            try {
              const res = await fetch(form.action, {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: params.toString()
              });

              // treat HTTP 200 as success (server renders HTML normally)
              if (res.ok) {
                // clear form
                form.reset();
                // show modal
                modal.style.display = 'flex';
                modal.setAttribute('aria-hidden','false');
              } else {
                // show minimal error feedback
                alert('Failed to post job. Please try again.');
              }

            } catch (err) {
              console.error(err);
              alert('Network error. Try again.');
            } finally {
              submitBtn.disabled = false;
              submitBtn.textContent = 'Post Job';
            }
          });

          modalClose.addEventListener('click', function(){
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden','true');
          });
        })();
    </script>
</body>
</html>